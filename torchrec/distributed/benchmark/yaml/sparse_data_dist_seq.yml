# this is a very basic sparse data dist config
# runs on 2 ranks, showing traces with reasonable workloads
RunOptions:
  world_size: 2
  num_batches: 5
  num_benchmarks: 2
  sharding_type: table_wise
  profile_dir: "."
  name: "sparse_data_dist_seq"
  # export_stacks: True # enable this to export stack traces
PipelineConfig:
  pipeline: "sparse"
ModelInputConfig:
  feature_pooling_avg: 10
EmbeddingTablesConfig:
  num_unweighted_features: 100
  num_weighted_features: 100
  embedding_feature_dim: 128
  additional_tables:
    - - name: FP16_table
        embedding_dim: 512
        num_embeddings: 100_000
        feature_names: ["additional_0_0"]
        data_type: FP16
      - name: large_table
        embedding_dim: 2048
        num_embeddings: 1_000_000
        feature_names: ["additional_0_1"]
    - []
    - - name: ec_likes
        embedding_dim: 32
        num_embeddings: 100_000
        feature_names: ["user_likes"]
        config_class: EmbeddingConfig
      - name: ec_clicks
        embedding_dim: 32
        num_embeddings: 100_000
        feature_names: ["user_clicks"]
        config_class: EmbeddingConfig
PlannerConfig:
  additional_constraints:
    large_table:
      sharding_types: [row_wise]
    ec_likes:
      sharding_types: [column_wise]
    ec_clicks:
      sharding_types: [column_wise]
ModelSelectionConfig:
  model_name: "dlseq"
  model_config:
    num_float_features: 10
    table_options:
      - {}
      - is_weighted: True
      - {}
