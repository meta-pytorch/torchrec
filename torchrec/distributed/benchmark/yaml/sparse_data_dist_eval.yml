# This is a very basic MP-ZCH benchmark configuration
#   MP-ZCH parameters have comments next to them below.
#   Note that MP-ZCH must be enabled for all tables in the model,
#      and MP-ZCH only works with row-wise sharding.
RunOptions:
  world_size: 2
  num_batches: 20
  num_benchmarks: 5
  num_profiles: 1
  sharding_type: table_wise
  profile_dir: "."
  name: "sparse_data_dist_eval"
PipelineConfig:
  pipeline: "eval-sdd"
ModelInputConfig:
  num_float_features: 1000
  feature_pooling_avg: 30
  use_variable_batch: False
ModelSelectionConfig:
  model_name: "test_sparse_nn"
  model_config:
    num_float_features: 1000
    submodule_kwargs:
      dense_arch_out_size: 1024
      over_arch_out_size: 4096
      over_arch_hidden_layers: 10
      dense_arch_hidden_sizes: [128, 128, 128]
EmbeddingTablesConfig:
  num_unweighted_features: 70
  num_weighted_features: 70
  embedding_feature_dim: 256
  additional_tables:
    - - name: FP16_table
        embedding_dim: 256
        num_embeddings: 100_000
        feature_names: ["additional_0_0"]
        data_type: FP16
PlannerConfig:
  # MP-ZCH only works with row-wise sharding
  additional_constraints:
    FP16_table:
      sharding_types: [row_wise]
