Search.setIndex({"docnames": ["api", "concepts", "datatypes-api-reference", "high-level-arch", "index", "inference-api-reference", "intro", "model-parallel-api-reference", "modules-api-reference", "overview", "planner-api-reference", "setup-torchrec"], "filenames": ["api.rst", "concepts.rst", "datatypes-api-reference.rst", "high-level-arch.rst", "index.rst", "inference-api-reference.rst", "intro.rst", "model-parallel-api-reference.rst", "modules-api-reference.rst", "overview.rst", "planner-api-reference.rst", "setup-torchrec.rst"], "titles": ["API reference", "TorchRec Concepts", "Data Types", "TorchRec High Level Architecture", "Welcome to the TorchRec documentation!", "Inference", "Intro", "Model Parallel", "Modules", "TorchRec Overview", "Planner", "Setup"], "terms": {"torchrec": [0, 2, 5, 6, 7, 8, 10], "provid": [0, 1, 3, 5, 6, 7, 9, 10], "comprehens": 0, "set": [0, 1, 4, 7, 10, 11], "build": [0, 3, 4, 6, 9, 11], "deploi": [0, 4, 9], "recommend": [0, 1, 3, 4, 6, 9], "system": [0, 1, 3, 4, 6, 9, 10], "scale": [0, 1, 3, 4, 6, 9], "thi": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11], "section": [0, 1, 2, 3, 4, 11], "cover": [0, 2], "core": [0, 11], "compon": [0, 1, 3, 9], "includ": [0, 1, 2, 6, 7], "data": [0, 1, 3, 6, 7, 8, 10, 11], "type": [0, 1, 3, 5, 7, 8, 10, 11], "spars": [0, 1, 2, 6, 7, 8, 11], "dens": [0, 2, 10], "featur": [0, 1, 2, 3, 4, 5, 6, 8, 9, 10], "modular": 0, "block": [0, 2, 6], "model": [0, 1, 5, 6, 8, 9, 10], "distribut": [0, 2, 3, 4, 5, 6, 7, 9, 10], "train": [0, 3, 4, 5, 6, 7, 8, 9, 10], "parallel": [0, 1, 6, 9], "optim": [0, 3, 5, 6, 7, 8, 9, 10], "infer": [0, 2, 6, 7, 8, 9, 10], "capabl": [0, 4, 6, 9], "jaggedtensor": [0, 2, 6, 8, 11], "keyedjaggedtensor": [0, 2, 6, 8, 11], "keyedtensor": [0, 1, 2, 8, 11], "modul": [0, 3, 5, 6, 7, 9, 10], "embeddingbagconfig": [0, 8, 11], "embeddingconfig": [0, 8], "baseembeddingconfig": [0, 8], "embeddingbagcollect": [0, 1, 3, 5, 7, 8, 10, 11], "embeddingcollect": [0, 1, 3, 5, 8], "planner": [0, 3, 6], "shardingplan": [0, 5, 7, 10], "embeddingshardingplann": [0, 7, 10], "embeddingenumer": [0, 10], "greedyperfpartition": [0, 10], "heuristicalstoragereserv": [0, 10], "greedypropos": [0, 10], "embeddingperfestim": [0, 10], "embeddingstorageestim": [0, 10], "distributedmodelparallel": [0, 6, 7, 10], "quantize_inference_model": [0, 5], "shard_quant_model": [0, 5], "recommendation system": [1, 3, 4, 6], "distributed train": [1, 3, 4, 6], "embedding bag": 1, "embed": [1, 2, 4, 6, 8, 9, 10, 11], "row wis": 1, "table wis": 1, "column wis": 1, "table row wis": 1, "sharder": [1, 5, 7, 10], "In": [1, 2, 3, 10, 11], "we": [1, 2, 3, 4, 8, 11], "learn": [1, 3, 4], "about": [1, 3], "kei": [1, 2, 6, 7, 8, 10], "design": [1, 3, 7, 9], "larg": [1, 3, 4, 9, 10], "us": [1, 2, 3, 4, 5, 7, 8, 10, 11], "pytorch": [1, 2, 3, 4, 6, 9, 11], "how": [1, 3, 11], "each": [1, 2, 3, 8, 10], "work": [1, 2, 11], "detail": [1, 3, 10], "review": [1, 4], "i": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "rest": 1, "ha": [1, 2, 3, 7], "specif": [1, 7, 9, 11], "input": [1, 2, 8, 10], "output": [1, 2, 3, 8, 10, 11], "its": [1, 2, 5, 7, 8, 10], "effici": [1, 3, 6, 9], "repres": [1, 2, 3, 8], "wrapper": [1, 7], "around": 1, "length": [1, 2, 8, 11], "offset": [1, 2, 8], "valu": [1, 2, 7, 8, 10, 11], "tensor": [1, 2, 6, 7, 8, 10, 11], "singular": 1, "multipl": [1, 3, 7, 10], "can": [1, 2, 3, 4, 5, 7, 9], "think": 1, "": [1, 2, 4, 6, 7, 8, 10, 11], "torch": [1, 2, 5, 7, 8, 10, 11], "allow": [1, 2, 3, 7, 9], "access": [1, 2, 3, 7], "through": [1, 3, 4, 8], "With": 1, "goal": 1, "high": [1, 6], "perform": [1, 2, 3, 6, 7, 8, 10], "canon": 1, "highli": 1, "ineffici": 1, "introduc": [1, 3], "new": [1, 2, 4, 7, 11], "becaus": [1, 10], "thei": [1, 2, 7, 10], "storag": [1, 2, 10], "represent": [1, 2, 10], "As": [1, 3], "you": [1, 2, 3, 4, 7, 11], "later": [1, 3], "make": [1, 2, 4], "commun": [1, 4, 9, 10], "environ": [1, 4, 5, 7, 9, 11], "veri": 1, "lead": 1, "one": [1, 3, 7], "advantag": 1, "end": [1, 3, 7, 10], "loop": 1, "compris": [1, 10], "follow": [1, 2, 4, 5, 8, 9], "main": [1, 3, 4, 7, 10], "take": [1, 7, 8, 10], "configur": [1, 7], "tabl": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11], "setup": [1, 4], "gener": [1, 2, 3, 5, 9, 10, 11], "an": [1, 2, 3, 4, 5, 7, 8, 10, 11], "plan": [1, 3, 5, 7, 9, 10], "accord": [1, 10], "differ": [1, 2, 3, 7], "strategi": [1, 6, 7, 10], "wise": [1, 6, 9], "row": [1, 3, 6, 9], "column": [1, 9], "combin": [1, 3], "entri": [1, 7], "point": [1, 7], "manner": 1, "A": [1, 2, 4, 7], "It": [1, 2, 3, 6, 7, 8], "call": [1, 2, 3, 5, 7, 10, 11], "jag": [1, 2, 6, 8], "variabl": [1, 2, 8], "sequenc": 1, "contrast": 1, "assum": [1, 2, 8], "same": [1, 2, 7], "which": [1, 2, 3, 5, 7, 8, 9, 11], "often": [1, 3], "case": [1, 2, 10], "real": [1, 3, 4, 10], "world": 1, "facilit": 1, "without": [1, 2, 7], "pad": [1, 2], "list": [1, 2, 5, 7, 8, 10], "integ": [1, 8], "number": [1, 2, 3, 5, 8, 10, 11], "element": 1, "entiti": [1, 3], "start": [1, 2], "index": [1, 2, 8, 11], "flatten": 1, "These": [1, 8], "altern": 1, "1d": 1, "contain": [1, 2, 3, 7], "actual": [1, 2], "store": [1, 2, 3], "contigu": 1, "here": [1, 3, 4], "simpl": [1, 9], "exampl": [1, 2, 4, 5, 7, 8, 10], "demonstr": [1, 11], "would": [1, 2], "look": [1, 3], "like": [1, 2, 3, 5, 7, 8, 10], "user": [1, 3, 7, 10, 11], "interact": [1, 4], "1": [1, 2, 3, 5, 7, 8, 10, 11], "2": [1, 2, 3, 7, 8, 10, 11], "item": 1, "3": [1, 2, 7, 8, 10, 11], "0": [1, 2, 7, 8, 10, 11], "5": [1, 2, 8, 11], "101": 1, "102": 1, "201": 1, "202": 1, "203": 1, "301": 1, "id": [1, 3, 8, 10], "jt": [1, 2], "OR": 1, "extend": [1, 9], "function": [1, 2, 7, 8, 10], "ar": [1, 2, 3, 4, 7, 8, 9, 10, 11], "typic": [1, 2, 10], "name": [1, 5, 7, 8, 10, 11], "label": 1, "group": [1, 2, 7, 10], "forward": [1, 3, 7, 8, 10, 11], "impli": 1, "batch": [1, 2, 3, 8, 10, 11], "size": [1, 2, 3, 7, 8, 10], "divid": [1, 3], "The": [1, 2, 5, 7, 8, 10], "below": [1, 11], "4": [1, 2, 7, 8, 10, 11], "similar": [1, 11], "from": [1, 2, 4, 5, 7, 8, 9, 10, 11], "user_featur": 1, "item_featur": 1, "respect": [1, 11], "11": [1, 2, 11], "12": [1, 2, 11], "21": 1, "22": 1, "23": 1, "creat": [1, 2, 7, 9], "kjt": [1, 2, 8, 10, 11], "print": [1, 7, 8, 10, 11], "help": [1, 4], "determin": [1, 9, 10], "best": [1, 9], "evalu": 1, "possibl": 1, "assess": 1, "memori": [1, 3, 5, 8, 9, 10], "constraint": [1, 5, 10], "hardwar": 1, "estim": [1, 10], "comput": [1, 2, 3, 7, 8, 10, 11], "requir": [1, 3, 7], "base": [1, 3, 8, 10], "fetch": [1, 10], "lookup": [1, 2, 3, 8, 10], "address": [1, 4, 9], "factor": [1, 10], "consid": [1, 2, 8, 10], "other": [1, 7, 10], "bandwidth": [1, 10], "To": [1, 11], "ensur": 1, "accur": 1, "consider": 1, "incorpor": 1, "inform": [1, 3, 10], "topologi": [1, 9, 10], "variou": 1, "outlin": 1, "some": [1, 2, 7, 9, 11], "well": [1, 3, 7], "benefit": [1, 3, 9], "limit": [1, 5], "find": [1, 4, 10], "your": [1, 4, 11], "do": [1, 2, 3, 7, 10], "split": [1, 2], "whether": [1, 2, 4, 7, 8, 10], "should": [1, 2, 7, 10, 11], "cut": 1, "up": [1, 3, 4, 11], "keep": 1, "few": 1, "copi": [1, 2, 3, 7], "so": [1, 2, 3, 8, 9], "piec": 1, "outcom": 1, "part": [1, 9], "refer": [1, 3, 7, 10, 11], "figur": [1, 3], "visual": [1, 2], "placement": [1, 7, 10], "under": 1, "scheme": 1, "offer": [1, 4], "all": [1, 2, 7, 8, 9, 10], "avail": [1, 7], "tw": [1, 10], "suggest": [1, 4], "kept": 1, "whole": [1, 7], "place": [1, 2, 10], "rank": [1, 2, 7, 10], "cw": [1, 10], "along": [1, 2], "emb_dim": 1, "dimens": [1, 2, 3, 8], "256": 1, "64": 1, "rw": [1, 10], "hash_siz": 1, "usual": [1, 2, 3], "evenli": 1, "among": 1, "twrw": [1, 10], "host": [1, 2, 10], "grid": 1, "g": [1, 5, 7], "dp": [1, 10], "onc": 1, "convert": 1, "version": [1, 5, 8], "themselv": 1, "known": [1, 2], "shardedembeddingcollect": [1, 8], "shardedembeddingbagcollect": [1, 8], "handl": [1, 3], "gradient": [1, 3], "mani": [1, 9, 11], "There": [1, 3, 4], "cost": [1, 10], "associ": 1, "conjunct": 1, "gpu": [1, 3, 6, 7, 11], "where": [1, 2, 3, 8, 10], "vector": [1, 3], "pass": [1, 2, 3, 7, 8, 11], "updat": [1, 3, 7, 9, 10], "backward": [1, 3, 10], "ad": [1, 3, 4, 7], "need": [1, 2, 3, 4, 7, 8], "ask": 1, "all2al": 1, "given": [1, 2, 3, 7, 10], "locat": 1, "send": 1, "target": 1, "That": [1, 2], "return": [1, 2, 3, 5, 7, 8, 10], "back": 1, "origin": [1, 2, 5, 7], "sent": 1, "accordingli": 1, "describ": [1, 3], "abov": [1, 2, 3, 11], "u": 1, "three": 1, "stage": 1, "input_dist": 1, "form": [1, 8], "appropri": 1, "devic": [1, 2, 5, 7, 8, 9, 10, 11], "relev": [1, 10], "after": [1, 7, 8, 9, 10], "exchang": 1, "output_dist": [1, 10], "receiv": 1, "doe": [1, 2], "oper": [1, 2, 10], "revers": 1, "order": [1, 7, 10], "diagram": [1, 3], "culmin": 1, "entrypoint": 1, "integr": [1, 6, 9, 11], "At": 1, "level": [1, 6], "initi": [1, 7, 8], "process": [1, 3, 6, 7, 10], "assign": [1, 2, 7], "default": [1, 2, 5, 7, 8, 10], "embeddingbagcollectionshard": [1, 7, 10], "none": [1, 2, 5, 7, 8, 10], "replac": 1, "them": [1, 2, 3, 7], "By": [1, 9], "wrap": [1, 7, 10], "distributeddataparallel": 1, "both": [1, 7, 11], "seamless": 1, "api": [1, 5, 7, 9, 10], "fuse": [1, 3], "step": [1, 4], "signific": [1, 3], "decreas": 1, "alongsid": 1, "granular": 1, "distinct": [1, 8], "paramet": [1, 2, 5, 7, 8, 10], "sensit": [1, 8], "two": [1, 3, 10], "quantiz": [1, 5], "lower": 1, "latenc": 1, "reduc": [1, 8], "let": [1, 11], "minim": 1, "c": [1, 2, 5, 7, 9], "even": 1, "further": 1, "ran": [1, 11], "being": [1, 5, 7, 9], "readi": [1, 2], "automat": [1, 2, 9], "fbgemm": [1, 9, 11], "tbe": 1, "compil": [1, 5], "torchscript": [1, 5], "compat": [1, 10], "notebook": 1, "otherwis": [2, 7, 10], "indic": [2, 8], "meant": [2, 8], "fed": 2, "For": [2, 3, 7, 8, 11], "therefor": [2, 11], "amount": 2, "class": [2, 7, 8, 10], "jagged_tensor": [2, 11], "arg": [2, 7], "kwarg": [2, 7], "option": [2, 5, 7, 8, 10], "weight": [2, 5, 7, 8, 10], "whose": 2, "slice": 2, "mai": [2, 11], "see": [2, 6, 7, 10, 11], "full": 2, "implement": [2, 5, 7], "jit": 2, "script": 2, "abl": [2, 3, 11], "NOT": 2, "valid": [2, 10], "expens": [2, 7], "alwai": [2, 4], "etc": 2, "have": [2, 3, 4, 7, 8, 10, 11], "shape": [2, 8], "cumul": 2, "get": [2, 3], "static": 2, "empti": 2, "is_weight": [2, 8, 10], "bool": [2, 7, 8, 10], "fals": [2, 7, 8, 10], "values_dtyp": 2, "dtype": [2, 5], "weights_dtyp": 2, "lengths_dtyp": 2, "int32": 2, "construct": [2, 8], "from_dens": 2, "b": [2, 3, 7, 8], "len": [2, 8], "2d": [2, 3], "7": [2, 8, 11], "8": [2, 8, 11], "10": [2, 8, 11], "j1": 2, "from_dense_length": 2, "note": [2, 3, 7, 8], "still": [2, 7], "If": [2, 4, 5, 7, 8, 10, 11], "lengths_or_non": 2, "offsets_or_non": 2, "record_stream": 2, "stream": 2, "http": [2, 4, 11], "org": [2, 11], "doc": 2, "stabl": [2, 11], "html": [2, 4], "non_block": 2, "move": [2, 7], "specifi": [2, 10], "asynchron": 2, "to_dens": 2, "6": [2, 8, 10], "inttensor": 2, "values_list": 2, "to_dense_weight": 2, "weights_list": 2, "to_padded_dens": 2, "desired_length": 2, "int": [2, 5, 8, 10], "padding_valu": 2, "float": [2, 7, 8, 10], "n": [2, 3], "self": [2, 5, 7, 10], "longest": 2, "select": [2, 7, 8, 10], "last": 2, "dt": 2, "to_padded_dense_weight": 2, "instead": [2, 3, 7, 10], "d_wt": 2, "throw": 2, "error": [2, 10], "weights_or_non": 2, "first": [2, 7, 10, 11], "str": [2, 5, 7, 8, 10], "stride": 2, "per": [2, 3, 7, 10], "stride_per_key_per_rank": 2, "union": [2, 10], "outer": 2, "inner": 2, "context": 2, "length_per_kei": 2, "offset_per_kei": [2, 8], "final": [2, 8, 10], "index_per_kei": 2, "dict": [2, 5, 7, 8, 10], "jt_dict": 2, "dictionari": [2, 7], "abil": [2, 11], "to_dict": 2, "lazi": [2, 7], "cacheabl": 2, "inverse_indic": 2, "tupl": [2, 5, 7], "invers": 2, "expand": [2, 8], "dedupl": 2, "dim_1": 2, "feature0": 2, "v0": 2, "v1": 2, "v2": 2, "feature1": 2, "v3": 2, "v4": 2, "v5": 2, "v6": 2, "v7": 2, "dim_0": 2, "ie": [2, 10], "second": 2, "dim_2": 2, "between": [2, 3, 7, 10], "v": 2, "ani": [2, 4, 7, 10], "datatyp": [2, 8], "w0": 2, "w1": 2, "w2": 2, "w3": 2, "w4": 2, "w5": 2, "w6": 2, "w7": 2, "w": 2, "correspond": [2, 3, 7, 8, 11], "concat": 2, "kjt_list": 2, "concaten": 2, "singl": [2, 3, 8, 10], "copy_": 2, "current": [2, 7, 10, 11], "side": 2, "meta": [2, 5, 7, 9, 10], "stride_per_kei": 2, "alreadi": [2, 7], "empty_lik": 2, "usag": [2, 3, 7, 10], "perserv": 2, "from_jt_dict": [2, 11], "sync": 2, "newli": 2, "onli": [2, 7, 8, 10, 11], "implicit": 2, "batch_siz": [2, 10], "basic": [2, 9, 11], "d": [2, 8], "format": 2, "x": [2, 8], "variable_feature_dim": 2, "could": 2, "just": [2, 10], "But": 2, "didn": 2, "t": [2, 3, 7, 10], "now": [2, 11], "left": 2, "out": [2, 3, 11], "fail": 2, "correctli": [2, 11], "technic": 2, "know": 2, "correct": 2, "within": [2, 4, 7, 10], "essenti": 2, "violat": 2, "exist": [2, 7, 8, 9, 10], "assumpt": 2, "precondit": 2, "fix": [2, 4], "from_lengths_sync": 2, "from_offsets_sync": [2, 8], "except": [2, 7], "inverse_indices_or_non": 2, "don": [2, 3], "length_per_key_or_non": 2, "hasn": 2, "been": [2, 3], "yet": 2, "lengths_offset_per_kei": 2, "offset_per_key_or_non": 2, "permut": 2, "indices_tensor": 2, "segment": [2, 3], "synchron": 2, "desir": [2, 5, 10], "non": [2, 8, 10], "fashion": [2, 10], "compute_offset": 2, "true": [2, 7, 10], "Will": [2, 10], "cach": [2, 10], "result": [2, 3, 7, 8, 10, 11], "_jt_dict": 2, "when": [2, 3, 7, 8, 10, 11], "unsync": 2, "clear": 2, "variable_stride_per_kei": 2, "_variable_stride_per_kei": 2, "_stride_per_key_per_rank": 2, "might": [2, 7], "extern": 2, "intention": 2, "trivial": 2, "hold": 2, "common": [2, 3, 6, 9], "pool": [2, 3, 6, 8, 10, 11], "key_dim": 2, "zero": 2, "kt": [2, 8], "tensor_list": 2, "from_tensor_list": 2, "cat_dim": 2, "regroup": 2, "keyed_tensor": 2, "regroup_as_dict": 2, "shard": [3, 4, 5, 6, 7, 8, 9, 10], "emploi": 3, "complex": [3, 4], "across": [3, 6, 7, 10], "enhanc": [3, 4], "manag": 3, "util": [3, 6, 9], "effect": [3, 10], "primit": [3, 9], "hybrid": 3, "pipelin": [3, 10], "more": [3, 9, 10], "modern": 3, "deep": 3, "becom": 3, "successfulli": 3, "suffici": [3, 11], "time": [3, 7, 10], "paradigm": 3, "approach": 3, "develop": [3, 9, 11], "focus": 3, "latter": [3, 7], "comparison": 3, "workload": [3, 6], "independ": 3, "suitabl": 3, "fit": 3, "entir": [3, 7], "subset": 3, "contribut": 3, "overal": 3, "effec": 3, "dataset": 3, "particularli": [3, 7], "benefici": 3, "enabl": [3, 10], "dlrm": 3, "what": 3, "relationship": 3, "dimension": 3, "space": [3, 8, 10], "mean": [3, 8, 9], "word": 3, "imag": 3, "aggreg": 3, "matrix": [3, 11], "most": [3, 5, 9, 10], "commonli": 3, "movi": 3, "titl": 3, "choic": 3, "re": 3, "give": 3, "rise": 3, "question": 3, "techniqu": [3, 4, 9], "sum": [3, 8, 10, 11], "produc": [3, 8], "nn": [3, 5, 7, 8, 10], "embeddingbag": [3, 8, 10], "collect": [3, 8, 10], "extens": 3, "kernel": [3, 10], "improv": [3, 4, 9], "flow": 3, "show": [3, 11], "grai": 3, "sinc": [3, 7, 10], "fulli": 3, "materi": [3, 8], "reduct": 3, "concept": [3, 6], "go": 3, "page": 3, "understand": [3, 11], "fundament": 3, "everyth": 3, "ti": 3, "togeth": [3, 11], "lot": 3, "ddp": [3, 7], "tutori": [3, 4], "special": [4, 9], "librari": [4, 6, 9, 11], "ecosystem": [4, 9], "tailor": 4, "nich": 4, "directli": [4, 7], "standard": [4, 8], "advanc": [4, 9], "massiv": [4, 6, 9], "topic": 4, "overview": [4, 6], "short": 4, "intro": 4, "why": [4, 6], "instal": 4, "our": 4, "life": 4, "colab": 4, "research": 4, "googl": 4, "com": 4, "github": 4, "blob": 4, "torchrec_introduct": 4, "ipynb": 4, "feedback": [4, 10], "interest": 4, "project": 4, "visit": 4, "repositori": 4, "sourc": [4, 11], "code": [4, 9, 11], "issu": 4, "ongo": 4, "submit": 4, "encount": 4, "bug": 4, "pleas": [4, 7], "tracker": [4, 7], "propos": [4, 10], "chang": [4, 7, 11], "fork": 4, "pull": 4, "request": 4, "sure": 4, "md": 4, "easi": 5, "transform": [5, 9], "author": [5, 9], "via": [5, 11], "eager": 5, "swap": [5, 11], "fx": 5, "intend": 5, "quantization_map": 5, "per_table_weight_dtyp": 5, "fp_weight_dtyp": 5, "int8": 5, "quantization_dtyp": 5, "output_dtyp": 5, "float32": 5, "counterpart": 5, "e": [5, 7, 10], "quantembeddingbagcollect": 5, "map": [5, 7, 10], "quantembeddingcollect": 5, "processor": 5, "featureprocessedembeddingbagcollect": 5, "ebc": [5, 7, 8, 10, 11], "eb_config": [5, 10], "dlrmpredictmodul": 5, "embedding_bag_collect": 5, "dense_in_featur": 5, "model_config": 5, "dense_arch_layer_s": 5, "over_arch_layer_s": 5, "id_list_features_kei": 5, "dense_devic": 5, "quant_model": 5, "world_siz": [5, 10], "compute_devic": [5, 10], "cuda": [5, 11], "sharding_devic": 5, "moduleshard": [5, 7, 10], "device_memory_s": 5, "parameterconstraint": [5, 10], "ddr_cap": 5, "sharding_plan": 5, "necessari": 5, "run": [5, 7, 8], "quantembeddingbagcollectionshard": 5, "quantembeddingcollectionshard": 5, "quantfeatureprocessedembeddingbagcollectionshard": 5, "tablewis": 5, "sharded_model": 5, "_": 5, "jagged tensor": 6, "fsdp": [6, 7], "recsi": [6, 10], "domain": 6, "compos": [6, 7, 10], "industri": 6, "focu": [6, 9], "bag": [6, 8], "categor": 6, "built": [6, 9], "support": [6, 9], "node": 6, "structur": 6, "architectur": 6, "also": [6, 7, 10, 11], "embeddingt": 6, "model_parallel": 7, "env": 7, "shardingenv": 7, "init_data_parallel": 7, "init_paramet": 7, "data_parallel_wrapp": 7, "dataparallelwrapp": 7, "model_tracker_config": 7, "modeltrackerconfig": 7, "cpu": [7, 11], "collective_plan": [7, 10], "delai": 7, "until": 7, "custom": 7, "deltatrackerconfig": 7, "config": [7, 8], "no_grad": 7, "def": 7, "init_weight": 7, "m": 7, "isinst": 7, "linear": 7, "fill_": 7, "elif": 7, "param": 7, "init": [7, 8], "kaiming_normal_": 7, "mymodel": 7, "appli": [7, 8], "recurs": 7, "submodul": 7, "shardedmodul": 7, "defin": [7, 8], "everi": 7, "overridden": 7, "subclass": 7, "although": 7, "recip": 7, "instanc": 7, "afterward": 7, "former": 7, "care": 7, "regist": 7, "hook": 7, "while": [7, 9], "silent": 7, "ignor": 7, "get_delta_track": 7, "modeldeltatrack": 7, "delta": 7, "tor": 7, "argument": [7, 8], "safe": 7, "method": [7, 8, 9, 10], "init_torchrec_delta_track": 7, "delta_tracker_config": 7, "doesn": 7, "load_state_dict": 7, "state_dict": 7, "ordereddict": 7, "prefix": 7, "strict": 7, "_incompatiblekei": 7, "buffer": 7, "descend": [7, 10], "must": 7, "exactli": 7, "match": [7, 11], "unless": 7, "get_swap_module_params_on_convers": 7, "persist": 7, "strictli": 7, "enforc": 7, "properti": [7, 8, 10], "preserv": 7, "wherea": 7, "state": [7, 9], "requires_grad": 7, "field": 7, "missing_kei": 7, "expect": [7, 10], "miss": 7, "unexpected_kei": 7, "present": 7, "namedtupl": 7, "rais": 7, "runtimeerror": 7, "dmp": 7, "named_buff": 7, "remove_dupl": 7, "iter": [7, 10], "over": 7, "yield": 7, "itself": 7, "prepend": 7, "direct": 7, "member": 7, "remov": 7, "duplic": 7, "xdoctest": 7, "skip": 7, "undefin": 7, "var": 7, "buf": 7, "running_var": 7, "named_paramet": 7, "bia": 7, "reshard": 7, "changed_shard_to_param": 7, "embeddingmoduleshardingplan": [7, 10], "sharded_module_fqn": 7, "parametershard": 7, "volum": 7, "dynam": [7, 8], "recreat": 7, "adapt": 7, "dure": [7, 10], "progress": 7, "rebalanc": 7, "load": [7, 9, 10], "test": [7, 11], "path_to_sharded_modul": 7, "path": [7, 9, 10], "original_plan": 7, "table_0": [7, 8], "sharding_typ": [7, 10], "table_wis": 7, "sharding_spec": 7, "enumerableshardingspec": 7, "new_plan": 7, "helper": 7, "changed_sharding_param": 7, "output_sharding_plan_delta": 7, "redistribut": 7, "embedding_modul": [7, 8], "involv": 7, "maintain": 7, "reflect": 7, "destin": 7, "keep_var": 7, "averag": [7, 10], "object": 7, "shallow": 7, "accept": 7, "posit": [7, 8], "howev": 7, "deprec": 7, "keyword": 7, "futur": 7, "releas": [7, 11], "avoid": 7, "detach": 7, "autograd": 7, "embedding_config": 8, "num_embed": [8, 11], "embedding_dim": [8, 11], "data_typ": 8, "fp32": 8, "feature_nam": [8, 11], "factori": 8, "weight_init_max": 8, "weight_init_min": 8, "num_embeddings_post_prun": 8, "init_fn": 8, "callabl": [8, 10], "need_po": 8, "input_dim": 8, "total_num_bucket": 8, "use_virtual_t": 8, "virtual_table_eviction_polici": 8, "virtualtableevictionpolici": 8, "enable_embedding_upd": 8, "poolingtyp": [8, 11], "dataclass": 8, "max": [8, 10], "min": 8, "prune": 8, "bucket": 8, "global": [8, 10], "unchang": 8, "lifetim": 8, "virtual": 8, "magnitud": 8, "50": 8, "pair": 8, "ssd": 8, "dram": 8, "talb": 8, "embeddingcomputekernel": 8, "evict": 8, "polici": 8, "unshard": 8, "scenario": 8, "f": 8, "l": 8, "potenti": 8, "j": 8, "cat": 8, "emb": 8, "mode": 8, "t1": 8, "f1": 8, "table_1": 8, "t2": 8, "f2": 8, "pooled_embed": 8, "dim": 8, "8899": 8, "1342": 8, "9060": 8, "0905": 8, "2814": 8, "9369": 8, "7783": 8, "0000": 8, "1598": 8, "0695": 8, "3265": 8, "1011": 8, "4256": 8, "1846": 8, "1648": 8, "0893": 8, "3590": 8, "9784": 8, "7681": 8, "grad_fn": 8, "catbackward0": 8, "embedding_bag_config": 8, "reset_paramet": 8, "reset": 8, "intiial": 8, "need_indic": 8, "use_gather_select": 8, "eb": 8, "equal": [8, 10], "rang": 8, "e1_config": 8, "e2_config": 8, "ec": 8, "feature_embed": 8, "2050": 8, "5478": 8, "6054": 8, "7352": 8, "3210": 8, "0399": 8, "1279": 8, "1756": 8, "4130": 8, "7519": 8, "4341": 8, "0499": 8, "9329": 8, "0697": 8, "8095": 8, "embeddingbackward": 8, "embedding_names_by_t": 8, "individu": 8, "gather": 8, "art": 9, "person": 9, "product": [9, 11], "wide": 9, "adopt": 9, "workflow": 9, "uniqu": 9, "challeng": 9, "regular": 9, "simplist": 9, "flexibl": 9, "customiz": 9, "balanc": [9, 10], "sophist": 9, "incredibli": 9, "top": 9, "power": 9, "largest": [9, 10], "frictionless": 9, "deploy": 9, "seamlessli": 9, "tool": 9, "leverag": 9, "knowledg": 9, "codebas": 9, "robust": 9, "continu": 9, "come": 9, "respons": 10, "moduleshardingplan": 10, "fqn": 10, "larger": 10, "spec": 10, "get_plan_for_modul": 10, "module_path": 10, "enumer": 10, "storage_reserv": 10, "storagereserv": 10, "partition": 10, "performance_model": 10, "perfmodel": 10, "stat": 10, "debug": 10, "callback": 10, "shardingopt": 10, "timeout_second": 10, "plan_load": 10, "planload": 10, "shardabl": 10, "reserv": 10, "pg": 10, "processgroup": 10, "broadcast": 10, "dist": 10, "shardestim": 10, "use_exact_enumerate_ord": 10, "exact": 10, "name_children": 10, "popul": 10, "populate_estim": 10, "sharding_opt": 10, "descript": 10, "sort_bi": 10, "sortbi": 10, "balance_modul": 10, "greedi": 10, "sort": 10, "perf": 10, "smaller": 10, "wai": 10, "partit": 10, "storage_constraint": 10, "hbm_per_devic": 10, "partition_bi": 10, "attribut": 10, "uniform": 10, "total": 10, "docstr": 10, "partition_by_devic": 10, "done": 10, "clariti": 10, "percentag": 10, "parameter_multipli": 10, "dense_tensor_estim": 10, "heurist": 10, "calcul": 10, "extra": 10, "percent": 10, "act": 10, "margin": 10, "beyond": 10, "multipli": 10, "last_reserved_topologi": 10, "recent": 10, "use_depth": 10, "threshold": 10, "On": 10, "tri": 10, "next": 10, "earli": 10, "stop": 10, "consecut": 10, "wors": 10, "perf_rat": 10, "than": 10, "best_perf_r": 10, "rate": 10, "search_spac": 10, "search": 10, "shard_estim": 10, "is_infer": 10, "wall": 10, "sharder_map": 10, "classmethod": 10, "perf_func_emb_wall_tim": 10, "shard_siz": 10, "compute_kernel": 10, "local_world_s": 10, "input_length": 10, "input_data_type_s": 10, "table_data_type_s": 10, "output_data_type_s": 10, "fwd_a2a_comm_data_type_s": 10, "bwd_a2a_comm_data_type_s": 10, "fwd_sr_comm_data_type_s": 10, "bwd_sr_comm_data_type_s": 10, "num_pool": 10, "hbm_mem_bw": 10, "ddr_mem_bw": 10, "hbm_to_ddr_mem_bw": 10, "comms_bandwidth": 10, "generalizedcommsbandwidth": 10, "bwd_compute_multipli": 10, "weighted_feature_bwd_compute_multipli": 10, "is_pool": 10, "caching_ratio": 10, "prefetch_pipelin": 10, "expected_cache_fetch": 10, "uneven_sharding_perf_multipli": 10, "attempt": 10, "rel": 10, "local_row": 10, "local_col": 10, "queri": 10, "pooling_mean": 10, "pooling_factor": 10, "data_parallel": 10, "fwd_comm_data_type_s": 10, "bwd_comm_data_type_s": 10, "sampl": 10, "ebf": 10, "event": 10, "hbm": 10, "ddr": 10, "hbm_to_ddr_bw": 10, "intra_host_bw": 10, "thread": 10, "inter_host_bw": 10, "machin": 10, "unpool": 10, "sequenti": 10, "signifi": 10, "score": 10, "ratio": 10, "prefetch": 10, "account": 10, "uneven": 10, "pipeline_typ": 10, "pipelinetyp": 10, "run_embedding_at_peak_memori": 10, "replic": 10, "fwd": 10, "bwd": 10, "execut": [10, 11], "peak": 10, "temporari": 10, "alloc": 10, "long": 10, "befor": 10, "count": 10, "toward": 10, "won": 10, "ll": [10, 11], "hidden": 10, "affect": 10, "old": 10, "agnost": 10, "formula": 10, "happen": [10, 11], "forwrad": 10, "begin": 10, "recommender system": 11, "routin": 11, "aw": 11, "linux": 11, "python": 11, "9": 11, "platform": 11, "asid": 11, "those": 11, "depend": 11, "upon": 11, "furthermor": 11, "cu121": 11, "cu118": 11, "cu124": 11, "pip": 11, "url": 11, "download": 11, "whl": 11, "torchmetr": 11, "pypi": 11, "nightli": 11, "latest": 11, "check": 11, "properli": 11, "import": 11, "product_t": 11, "16": 11, "4096": 11, "user_t": 11, "product_jt": 11, "user_jt": 11, "q1": 11, "save": 11, "file": 11, "torchrec_exampl": 11, "py": 11, "Then": 11, "termin": 11, "congrat": 11, "program": 11}, "objects": {"torchrec.distributed": [[7, 0, 0, "-", "model_parallel"], [10, 0, 0, "-", "types"]], "torchrec.distributed.model_parallel": [[7, 1, 1, "", "DistributedModelParallel"]], "torchrec.distributed.model_parallel.DistributedModelParallel": [[7, 2, 1, "", "copy"], [7, 2, 1, "", "forward"], [7, 2, 1, "", "get_delta_tracker"], [7, 2, 1, "", "init_data_parallel"], [7, 2, 1, "", "init_torchrec_delta_tracker"], [7, 2, 1, "", "load_state_dict"], [7, 3, 1, "", "module"], [7, 2, 1, "", "named_buffers"], [7, 2, 1, "", "named_parameters"], [7, 2, 1, "", "reshard"], [7, 2, 1, "", "state_dict"]], "torchrec.distributed.planner": [[10, 0, 0, "-", "enumerators"], [10, 0, 0, "-", "partitioners"], [10, 0, 0, "-", "planners"], [10, 0, 0, "-", "proposers"], [10, 0, 0, "module-0", "shard_estimators"], [10, 0, 0, "-", "storage_reservations"]], "torchrec.distributed.planner.enumerators": [[10, 1, 1, "", "EmbeddingEnumerator"]], "torchrec.distributed.planner.enumerators.EmbeddingEnumerator": [[10, 2, 1, "", "enumerate"], [10, 2, 1, "", "populate_estimates"]], "torchrec.distributed.planner.partitioners": [[10, 1, 1, "", "GreedyPerfPartitioner"]], "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner": [[10, 2, 1, "", "partition"]], "torchrec.distributed.planner.planners": [[10, 1, 1, "", "EmbeddingShardingPlanner"]], "torchrec.distributed.planner.planners.EmbeddingShardingPlanner": [[10, 2, 1, "", "collective_plan"], [10, 2, 1, "", "plan"]], "torchrec.distributed.planner.proposers": [[10, 1, 1, "", "GreedyProposer"]], "torchrec.distributed.planner.proposers.GreedyProposer": [[10, 2, 1, "", "feedback"], [10, 2, 1, "", "load"], [10, 2, 1, "", "propose"]], "torchrec.distributed.planner.shard_estimators": [[10, 1, 1, "", "EmbeddingPerfEstimator"], [10, 1, 1, "", "EmbeddingStorageEstimator"]], "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator": [[10, 2, 1, "", "estimate"], [10, 2, 1, "", "perf_func_emb_wall_time"]], "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator": [[10, 2, 1, "", "estimate"]], "torchrec.distributed.planner.storage_reservations": [[10, 1, 1, "", "HeuristicalStorageReservation"]], "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation": [[10, 3, 1, "", "last_reserved_topology"]], "torchrec.distributed.types": [[10, 1, 1, "", "ShardingPlan"]], "torchrec.distributed.types.ShardingPlan": [[10, 2, 1, "", "get_plan_for_module"], [10, 4, 1, "", "plan"]], "torchrec.inference": [[5, 0, 0, "-", "modules"]], "torchrec.inference.modules": [[5, 5, 1, "", "quantize_inference_model"], [5, 5, 1, "", "shard_quant_model"]], "torchrec.modules": [[8, 0, 0, "-", "embedding_configs"], [8, 0, 0, "-", "embedding_modules"]], "torchrec.modules.embedding_configs": [[8, 1, 1, "", "BaseEmbeddingConfig"], [8, 1, 1, "", "EmbeddingBagConfig"], [8, 1, 1, "", "EmbeddingConfig"]], "torchrec.modules.embedding_modules": [[8, 1, 1, "", "EmbeddingBagCollection"], [8, 1, 1, "", "EmbeddingCollection"]], "torchrec.modules.embedding_modules.EmbeddingBagCollection": [[8, 3, 1, "", "device"], [8, 2, 1, "", "embedding_bag_configs"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "is_weighted"], [8, 2, 1, "", "reset_parameters"]], "torchrec.modules.embedding_modules.EmbeddingCollection": [[8, 3, 1, "", "device"], [8, 2, 1, "", "embedding_configs"], [8, 2, 1, "", "embedding_dim"], [8, 2, 1, "", "embedding_names_by_table"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "need_indices"], [8, 2, 1, "", "reset_parameters"], [8, 2, 1, "", "use_gather_select"]], "torchrec.sparse": [[2, 0, 0, "-", "jagged_tensor"]], "torchrec.sparse.jagged_tensor": [[2, 1, 1, "", "JaggedTensor"], [2, 1, 1, "", "KeyedJaggedTensor"], [2, 1, 1, "", "KeyedTensor"]], "torchrec.sparse.jagged_tensor.JaggedTensor": [[2, 2, 1, "", "device"], [2, 2, 1, "", "empty"], [2, 2, 1, "", "from_dense"], [2, 2, 1, "", "from_dense_lengths"], [2, 2, 1, "", "lengths"], [2, 2, 1, "", "lengths_or_none"], [2, 2, 1, "", "offsets"], [2, 2, 1, "", "offsets_or_none"], [2, 2, 1, "", "record_stream"], [2, 2, 1, "", "to"], [2, 2, 1, "", "to_dense"], [2, 2, 1, "", "to_dense_weights"], [2, 2, 1, "", "to_padded_dense"], [2, 2, 1, "", "to_padded_dense_weights"], [2, 2, 1, "", "values"], [2, 2, 1, "", "weights"], [2, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedJaggedTensor": [[2, 2, 1, "", "concat"], [2, 2, 1, "", "copy_"], [2, 2, 1, "", "device"], [2, 2, 1, "", "empty"], [2, 2, 1, "", "empty_like"], [2, 2, 1, "", "from_jt_dict"], [2, 2, 1, "", "from_lengths_sync"], [2, 2, 1, "", "from_offsets_sync"], [2, 2, 1, "", "index_per_key"], [2, 2, 1, "", "inverse_indices"], [2, 2, 1, "", "inverse_indices_or_none"], [2, 2, 1, "", "keys"], [2, 2, 1, "", "length_per_key"], [2, 2, 1, "", "length_per_key_or_none"], [2, 2, 1, "", "lengths"], [2, 2, 1, "", "lengths_offset_per_key"], [2, 2, 1, "", "lengths_or_none"], [2, 2, 1, "", "offset_per_key"], [2, 2, 1, "", "offset_per_key_or_none"], [2, 2, 1, "", "offsets"], [2, 2, 1, "", "offsets_or_none"], [2, 2, 1, "", "permute"], [2, 2, 1, "", "record_stream"], [2, 2, 1, "", "split"], [2, 2, 1, "", "stride"], [2, 2, 1, "", "stride_per_key"], [2, 2, 1, "", "stride_per_key_per_rank"], [2, 2, 1, "", "sync"], [2, 2, 1, "", "to"], [2, 2, 1, "", "to_dict"], [2, 2, 1, "", "unsync"], [2, 2, 1, "", "values"], [2, 2, 1, "", "variable_stride_per_key"], [2, 2, 1, "", "weights"], [2, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedTensor": [[2, 2, 1, "", "device"], [2, 2, 1, "", "from_tensor_list"], [2, 2, 1, "", "key_dim"], [2, 2, 1, "", "keys"], [2, 2, 1, "", "length_per_key"], [2, 2, 1, "", "offset_per_key"], [2, 2, 1, "", "record_stream"], [2, 2, 1, "", "regroup"], [2, 2, 1, "", "regroup_as_dict"], [2, 2, 1, "", "to"], [2, 2, 1, "", "to_dict"], [2, 2, 1, "", "values"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:property", "4": "py:attribute", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "refer": 0, "torchrec": [1, 3, 4, 9, 11], "concept": 1, "jaggedtensor": 1, "keyedjaggedtensor": 1, "planner": [1, 10], "shard": 1, "embeddingt": 1, "distribut": 1, "train": 1, "modul": [1, 8], "distributedmodelparallel": 1, "optim": 1, "infer": [1, 5], "see": [1, 3], "also": [1, 3], "data": 2, "type": 2, "high": 3, "level": 3, "architectur": 3, "": 3, "parallel": [3, 7], "strategi": 3, "model": [3, 7], "embed": 3, "tabl": 3, "welcom": 4, "document": 4, "get": 4, "start": 4, "how": 4, "contribut": 4, "intro": 6, "overview": 9, "why": 9, "setup": 11, "system": 11, "requir": 11, "version": 11, "compat": 11, "instal": 11, "run": 11, "simpl": 11, "exampl": 11}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 60}, "alltitles": {"API reference": [[0, "api-reference"]], "TorchRec Concepts": [[1, "torchrec-concepts"]], "JaggedTensor": [[1, "jaggedtensor"]], "KeyedJaggedTensor": [[1, "keyedjaggedtensor"]], "Planner": [[1, "planner"], [10, "planner"]], "Sharding of EmbeddingTables": [[1, "sharding-of-embeddingtables"]], "Distributed Training with TorchRec Sharded Modules": [[1, "distributed-training-with-torchrec-sharded-modules"]], "DistributedModelParallel": [[1, "distributedmodelparallel"]], "Optimizer": [[1, "optimizer"]], "Inference": [[1, "inference"], [5, "inference"]], "See Also": [[1, "see-also"]], "Data Types": [[2, "data-types"]], "TorchRec High Level Architecture": [[3, "torchrec-high-level-architecture"]], "TorchRec\u2019s Parallelism Strategy: Model Parallelism": [[3, "torchrec-s-parallelism-strategy-model-parallelism"]], "Embedding Tables": [[3, "embedding-tables"]], "See also": [[3, "see-also"]], "Welcome to the TorchRec documentation!": [[4, "welcome-to-the-torchrec-documentation"]], "Getting Started": [[4, "getting-started"]], "How to Contribute": [[4, "how-to-contribute"]], "Intro": [[6, "intro"]], "Model Parallel": [[7, "model-parallel"]], "Modules": [[8, "modules"]], "TorchRec Overview": [[9, "torchrec-overview"]], "Why TorchRec?": [[9, "why-torchrec"]], "Setup": [[11, "setup"]], "System Requirements": [[11, "system-requirements"]], "Version Compatability": [[11, "version-compatability"]], "Installation": [[11, "installation"]], "Run a Simple TorchRec Example": [[11, "run-a-simple-torchrec-example"]]}, "indexentries": {"jaggedtensor (class in torchrec.sparse.jagged_tensor)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor"]], "keyedjaggedtensor (class in torchrec.sparse.jagged_tensor)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor"]], "keyedtensor (class in torchrec.sparse.jagged_tensor)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor"]], "concat() (torchrec.sparse.jagged_tensor.keyedjaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.concat"]], "copy_() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.copy_"]], "device() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.device"]], "device() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.device"]], "device() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.device"]], "empty() (torchrec.sparse.jagged_tensor.jaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.empty"]], "empty() (torchrec.sparse.jagged_tensor.keyedjaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.empty"]], "empty_like() (torchrec.sparse.jagged_tensor.keyedjaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.empty_like"]], "from_dense() (torchrec.sparse.jagged_tensor.jaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.from_dense"]], "from_dense_lengths() (torchrec.sparse.jagged_tensor.jaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.from_dense_lengths"]], "from_jt_dict() (torchrec.sparse.jagged_tensor.keyedjaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.from_jt_dict"]], "from_lengths_sync() (torchrec.sparse.jagged_tensor.keyedjaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.from_lengths_sync"]], "from_offsets_sync() (torchrec.sparse.jagged_tensor.keyedjaggedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.from_offsets_sync"]], "from_tensor_list() (torchrec.sparse.jagged_tensor.keyedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.from_tensor_list"]], "index_per_key() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.index_per_key"]], "inverse_indices() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.inverse_indices"]], "inverse_indices_or_none() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.inverse_indices_or_none"]], "key_dim() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.key_dim"]], "keys() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.keys"]], "keys() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.keys"]], "length_per_key() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.length_per_key"]], "length_per_key() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.length_per_key"]], "length_per_key_or_none() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.length_per_key_or_none"]], "lengths() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.lengths"]], "lengths() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.lengths"]], "lengths_offset_per_key() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.lengths_offset_per_key"]], "lengths_or_none() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.lengths_or_none"]], "lengths_or_none() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.lengths_or_none"]], "module": [[2, "module-torchrec.sparse.jagged_tensor"], [5, "module-torchrec.inference.modules"], [7, "module-torchrec.distributed.model_parallel"], [8, "module-torchrec.modules.embedding_configs"], [8, "module-torchrec.modules.embedding_modules"], [10, "module-0"], [10, "module-torchrec.distributed.planner.enumerators"], [10, "module-torchrec.distributed.planner.partitioners"], [10, "module-torchrec.distributed.planner.planners"], [10, "module-torchrec.distributed.planner.proposers"], [10, "module-torchrec.distributed.planner.shard_estimators"], [10, "module-torchrec.distributed.planner.storage_reservations"], [10, "module-torchrec.distributed.types"]], "offset_per_key() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.offset_per_key"]], "offset_per_key() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.offset_per_key"]], "offset_per_key_or_none() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.offset_per_key_or_none"]], "offsets() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.offsets"]], "offsets() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.offsets"]], "offsets_or_none() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.offsets_or_none"]], "offsets_or_none() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.offsets_or_none"]], "permute() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.permute"]], "record_stream() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.record_stream"]], "record_stream() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.record_stream"]], "record_stream() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.record_stream"]], "regroup() (torchrec.sparse.jagged_tensor.keyedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.regroup"]], "regroup_as_dict() (torchrec.sparse.jagged_tensor.keyedtensor static method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.regroup_as_dict"]], "split() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.split"]], "stride() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.stride"]], "stride_per_key() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.stride_per_key"]], "stride_per_key_per_rank() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.stride_per_key_per_rank"]], "sync() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.sync"]], "to() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.to"]], "to() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.to"]], "to() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.to"]], "to_dense() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.to_dense"]], "to_dense_weights() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.to_dense_weights"]], "to_dict() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.to_dict"]], "to_dict() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.to_dict"]], "to_padded_dense() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.to_padded_dense"]], "to_padded_dense_weights() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.to_padded_dense_weights"]], "torchrec.sparse.jagged_tensor": [[2, "module-torchrec.sparse.jagged_tensor"]], "unsync() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.unsync"]], "values() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.values"]], "values() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.values"]], "values() (torchrec.sparse.jagged_tensor.keyedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedTensor.values"]], "variable_stride_per_key() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.variable_stride_per_key"]], "weights() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.weights"]], "weights() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.weights"]], "weights_or_none() (torchrec.sparse.jagged_tensor.jaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.JaggedTensor.weights_or_none"]], "weights_or_none() (torchrec.sparse.jagged_tensor.keyedjaggedtensor method)": [[2, "torchrec.sparse.jagged_tensor.KeyedJaggedTensor.weights_or_none"]], "quantize_inference_model() (in module torchrec.inference.modules)": [[5, "torchrec.inference.modules.quantize_inference_model"]], "shard_quant_model() (in module torchrec.inference.modules)": [[5, "torchrec.inference.modules.shard_quant_model"]], "torchrec.inference.modules": [[5, "module-torchrec.inference.modules"]], "distributedmodelparallel (class in torchrec.distributed.model_parallel)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel"]], "copy() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.copy"]], "forward() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.forward"]], "get_delta_tracker() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.get_delta_tracker"]], "init_data_parallel() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.init_data_parallel"]], "init_torchrec_delta_tracker() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.init_torchrec_delta_tracker"]], "load_state_dict() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.load_state_dict"]], "module (torchrec.distributed.model_parallel.distributedmodelparallel property)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.module"]], "named_buffers() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.named_buffers"]], "named_parameters() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.named_parameters"]], "reshard() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.reshard"]], "state_dict() (torchrec.distributed.model_parallel.distributedmodelparallel method)": [[7, "torchrec.distributed.model_parallel.DistributedModelParallel.state_dict"]], "torchrec.distributed.model_parallel": [[7, "module-torchrec.distributed.model_parallel"]], "baseembeddingconfig (class in torchrec.modules.embedding_configs)": [[8, "torchrec.modules.embedding_configs.BaseEmbeddingConfig"]], "embeddingbagcollection (class in torchrec.modules.embedding_modules)": [[8, "torchrec.modules.embedding_modules.EmbeddingBagCollection"]], "embeddingbagconfig (class in torchrec.modules.embedding_configs)": [[8, "torchrec.modules.embedding_configs.EmbeddingBagConfig"]], "embeddingcollection (class in torchrec.modules.embedding_modules)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection"]], "embeddingconfig (class in torchrec.modules.embedding_configs)": [[8, "torchrec.modules.embedding_configs.EmbeddingConfig"]], "device (torchrec.modules.embedding_modules.embeddingbagcollection property)": [[8, "torchrec.modules.embedding_modules.EmbeddingBagCollection.device"]], "device (torchrec.modules.embedding_modules.embeddingcollection property)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.device"]], "embedding_bag_configs() (torchrec.modules.embedding_modules.embeddingbagcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingBagCollection.embedding_bag_configs"]], "embedding_configs() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.embedding_configs"]], "embedding_dim() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.embedding_dim"]], "embedding_names_by_table() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.embedding_names_by_table"]], "forward() (torchrec.modules.embedding_modules.embeddingbagcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingBagCollection.forward"]], "forward() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.forward"]], "is_weighted() (torchrec.modules.embedding_modules.embeddingbagcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingBagCollection.is_weighted"]], "need_indices() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.need_indices"]], "reset_parameters() (torchrec.modules.embedding_modules.embeddingbagcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingBagCollection.reset_parameters"]], "reset_parameters() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.reset_parameters"]], "torchrec.modules.embedding_configs": [[8, "module-torchrec.modules.embedding_configs"]], "torchrec.modules.embedding_modules": [[8, "module-torchrec.modules.embedding_modules"]], "use_gather_select() (torchrec.modules.embedding_modules.embeddingcollection method)": [[8, "torchrec.modules.embedding_modules.EmbeddingCollection.use_gather_select"]], "embeddingenumerator (class in torchrec.distributed.planner.enumerators)": [[10, "torchrec.distributed.planner.enumerators.EmbeddingEnumerator"]], "embeddingperfestimator (class in torchrec.distributed.planner.shard_estimators)": [[10, "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator"]], "embeddingshardingplanner (class in torchrec.distributed.planner.planners)": [[10, "torchrec.distributed.planner.planners.EmbeddingShardingPlanner"]], "embeddingstorageestimator (class in torchrec.distributed.planner.shard_estimators)": [[10, "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator"]], "greedyperfpartitioner (class in torchrec.distributed.planner.partitioners)": [[10, "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner"]], "greedyproposer (class in torchrec.distributed.planner.proposers)": [[10, "torchrec.distributed.planner.proposers.GreedyProposer"]], "heuristicalstoragereservation (class in torchrec.distributed.planner.storage_reservations)": [[10, "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation"]], "shardingplan (class in torchrec.distributed.types)": [[10, "torchrec.distributed.types.ShardingPlan"]], "collective_plan() (torchrec.distributed.planner.planners.embeddingshardingplanner method)": [[10, "torchrec.distributed.planner.planners.EmbeddingShardingPlanner.collective_plan"]], "enumerate() (torchrec.distributed.planner.enumerators.embeddingenumerator method)": [[10, "torchrec.distributed.planner.enumerators.EmbeddingEnumerator.enumerate"]], "estimate() (torchrec.distributed.planner.shard_estimators.embeddingperfestimator method)": [[10, "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator.estimate"]], "estimate() (torchrec.distributed.planner.shard_estimators.embeddingstorageestimator method)": [[10, "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator.estimate"]], "feedback() (torchrec.distributed.planner.proposers.greedyproposer method)": [[10, "torchrec.distributed.planner.proposers.GreedyProposer.feedback"]], "get_plan_for_module() (torchrec.distributed.types.shardingplan method)": [[10, "torchrec.distributed.types.ShardingPlan.get_plan_for_module"]], "last_reserved_topology (torchrec.distributed.planner.storage_reservations.heuristicalstoragereservation property)": [[10, "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation.last_reserved_topology"]], "load() (torchrec.distributed.planner.proposers.greedyproposer method)": [[10, "torchrec.distributed.planner.proposers.GreedyProposer.load"]], "partition() (torchrec.distributed.planner.partitioners.greedyperfpartitioner method)": [[10, "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner.partition"]], "perf_func_emb_wall_time() (torchrec.distributed.planner.shard_estimators.embeddingperfestimator class method)": [[10, "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator.perf_func_emb_wall_time"]], "plan (torchrec.distributed.types.shardingplan attribute)": [[10, "torchrec.distributed.types.ShardingPlan.plan"]], "plan() (torchrec.distributed.planner.planners.embeddingshardingplanner method)": [[10, "torchrec.distributed.planner.planners.EmbeddingShardingPlanner.plan"]], "populate_estimates() (torchrec.distributed.planner.enumerators.embeddingenumerator method)": [[10, "torchrec.distributed.planner.enumerators.EmbeddingEnumerator.populate_estimates"]], "propose() (torchrec.distributed.planner.proposers.greedyproposer method)": [[10, "torchrec.distributed.planner.proposers.GreedyProposer.propose"]], "torchrec.distributed.planner.enumerators": [[10, "module-torchrec.distributed.planner.enumerators"]], "torchrec.distributed.planner.partitioners": [[10, "module-torchrec.distributed.planner.partitioners"]], "torchrec.distributed.planner.planners": [[10, "module-torchrec.distributed.planner.planners"]], "torchrec.distributed.planner.proposers": [[10, "module-torchrec.distributed.planner.proposers"]], "torchrec.distributed.planner.shard_estimators": [[10, "module-0"], [10, "module-torchrec.distributed.planner.shard_estimators"]], "torchrec.distributed.planner.storage_reservations": [[10, "module-torchrec.distributed.planner.storage_reservations"]], "torchrec.distributed.types": [[10, "module-torchrec.distributed.types"]]}})